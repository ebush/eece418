<!DOCTYPE html>
<html>
<head>
<title>Collaborative Meeting Finder</title>
<link rel="stylesheet" href="style.css">
<script src="jquery-2.1.3.min.js"></script>

<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>


<link rel="stylesheet" href="responsive-checkout-progress-bar/css/style.css">
</head>
<body>

<nav class="navbar navbar-inverse navbar-static-top">
   <div class="navbar-header">
      <a class="navbar-brand" href="#">Junction</a>
    </div>
</nav>
	
	<div class = "row">
		<div class = "col-xs-2"></div>
		<div class ="col-xs-8">
			<div class="checkout-wrap">
		  <ul class="checkout-bar">
		
		    <li class="first visited">
		      <a href="#">Event Details</a>
		    </li>
		
		    <li class="previously visited">Vote on Location</li>
		
		    <li class="active">Add Availability</li>
		
		    <li class="next">Invite Participants</li>
		
		    <li class="">View Best Time!</li>
		
		  </ul>
		  </div>
		</div>
		<div class = "col-xs-2"></div>
	</div>
	
	<div class="row">&nbsp;</div>
	<div class="row">&nbsp;</div>
	<div class="row">&nbsp;</div>
	<div class="row">&nbsp;</div>
	<div class="row">&nbsp;</div>
	
	  	
	<h1 class="text-center">What times are you available?</h1>
	<div class="row">&nbsp;</div>

	<div class="row" id='rowheight'>
		<div class="col-xs-2"></div>
		<div class="col-xs-5">
			<div id='calendar'></div>
		</div>
		<div class="col-xs-3">
				<div class="btn-group-vertical" role="group" aria-label="...">
				  <button type="button" class="btn btn-default" onclick="alertImport()">Import From Google</button>
				  <button type="button" class="btn btn-default" onclick="alertImport()">Import From Outlook</button>
				</div>
		</div>
	</div>



	

  <div class="row">&nbsp;</div>
	<div class="row">&nbsp;</div>

 
	<div class ="row">
  <div class="col-xs-6"><p class="text-center"><a class="btn btn-primary btn-lg" href="availability.html" role="button">Back</a></p></div>
  
  <div class="col-xs-6"><p class="text-center"><a class="btn btn-primary btn-lg" href="invitepeople.html" role="button">Next</a></p></div>
	</div>
	
</body>
<script>
$(document).ready(function(){
	var i = 1;
	
	$(document).keypress(function(e) {

    if(e.which == 13 && $("#Location0").val()!= "") {
        console.log($("#Location0").val());
        $("#locationlist").append("<div class=\"row\"> <label>" +
		    		"<input type=\"radio\" name=\"optionsRadios\" id= \"optionsRadios"+i+" value=\"option"+i+" checked>"+
		    		"  "+$("#Location0").val()+
		    		"</label></div>");
		    i = i + 1;
    }
   });

});
</script>


<link href='fullcalendar-2.3.1/fullcalendar.min.css' rel='stylesheet' />
<link href='fullcalendar-2.3.1/fullcalendar.print.css' rel='stylesheet' media='print' />
<script src='http://momentjs.com/downloads/moment.js'></script>

<script src='fullcalendar-2.3.1/fullcalendar.min.js'></script>


<script>
function alertImport(){
	alert("LOGIN TO CALENDAR");
	
	    var monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-05T09:00:00';
	    monthSource.end = '2015-04-05T10:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    var month = new Array();
	    month[0] = monthSource;
	    
	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-06T16:00:00';
	    monthSource.end = '2015-04-06T17:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[1] = monthSource;
	    
	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-07T11:00:00';
	    monthSource.end = '2015-04-07T12:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[2] = monthSource;
	    
	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-08T811:00:00';
	    monthSource.end = '2015-04-08T12:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[3] = monthSource;
	    
	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-08T13:00:00';
	    monthSource.end = '2015-04-08T14:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[4] = monthSource;
	    
  	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-10T12:00:00';
	    monthSource.end = '2015-04-10T13:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[5] = monthSource;
	    
	    monthSource = new Object();
	    monthSource.title = 'BUSY'; // this should be string
	    monthSource.start = '2015-04-11T12:00:00';
	    monthSource.end = '2015-04-11T13:00:00';	
	    monthSource.editable = false;
	    monthSource.color = "#C4C4C4";
	
	    month[6] = monthSource;
	
  	$('#calendar').fullCalendar('addEventSource', month);
}

function removeDate(element){
	console.log($(element).attr("name"));
	var elemid = $(element).attr("name");
	$("#"+elemid).remove();
	var startdate = moment (elemid);
	
	$('#calendar').fullCalendar( 'removeEvents', function(event) {
		console.log(event.start.format("YYYY-MM-DD") +" =? "+startdate.format("YYYY-MM-DD"));
    if(event.start.format("YYYY-MM-DD")===startdate.format("YYYY-MM-DD")){
    		
        return true;
    }
  });	
}

function cannotattend(){
	$('#calendar').fullCalendar('removeEvents');
	
	$("#datelist").empty();
	$("#datelist").append("<li class=\"list-group-item\" id='cannotattend'>Unavailable For Any Day</li>");

}

function GetURLParameters()
{
    var sPageURL = window.location.search.substring(1);
    var sURLVariables = sPageURL.split('&');
    var dates = [];
    for (var i = 0; i < sURLVariables.length; i++)
    {
        dates[i] = sURLVariables[i].split('=');
        //console.log(dates[i]);
    }
    //return JSON.stringify(dates);
    return dates;
}

	$(document).ready(function() {
		
		$('#calendar').fullCalendar({
			header: {
				left: 'prev,next today',
				center: 'title',
				right: null
			},
			views: {
        week: { // name of view
            titleFormat:"MMMM DD"
            // other view-specific options here
        }
      },           eventClick: function(calEvent, jsEvent, view) {
		console.log("eventClick");
		console.log(calEvent._id);
	       $('#calendar').fullCalendar( 'removeEvents', calEvent._id );

    },
			events: function(start, end, timezone, callback){
				 var dates = GetURLParameters();
				 //console.log(dates);
				 var events = [];
         dates.forEach(function(entry) {
           events.push({
             title: 'Available',
             start: entry[1]+"T00:01:00",
             end: entry[1]+"T11:59:59"
           });
           
           if($("#"+entry[1]).length){
	           
           }else{
	           //$("#datelist").append("<li class=\"list-group-item\" id='"+entry[1]+"'>"+entry[1]+" - All Day"+"<a href='#' onclick='removeDate(this)' name='"+entry[1]+"'> <span class=\"glyphicon glyphicon-remove\" aria-hidden=\"true\"></span></a></li>");   
           }

						
         });
         
         //console.log(events);
         
         callback(events);
			},
			defaultView: 'agendaWeek',
			selectable: true,
			selectHelper: true,
			height: 500,
			select: function(start, end) {
				var title = "Available";
				//console.log($('#calendar').fullCalendar('clientEvents'));
				var eventData;
				if (title) {
					
					
					while (start.isBefore(end)){
						var stringDate = start.format("MM-DD-YYYY");
						eventData = {
							title: title,
							start: start,
							end: start
						};
						
						$('#calendar').fullCalendar('renderEvent', eventData, true); // stick? = true
						
						//$("#datelist").append("<li class=\"list-group-item\" id='"+start.format("YYYY-MM-DDhh:mm:ss")+"'>"+start.format("MMMM D, YYYY h:mm:ss a")+"<a href='#' onclick='removeDate(this)' name='"+start.format("YYYY-MM-DDhh:mm:ss")+"'> <span class=\"glyphicon glyphicon-remove\" aria-hidden=\"true\"></span></a></li>");
						start.add(1, 'days');
						
						$("#cannotattend").remove();
					}
					
					console.log(start);
				}
				$('#calendar').fullCalendar('unselect');
			},
			editable: true,
			eventResize: function(event, delta, revertFunc) {
				console.log(event);
				
			}
      
		});
		
		GetURLParameters();
	
		
	});
	




</script>
<style>

	body {
		margin: 40px 10px;
		padding: 0;
		font-family: "Lucida Grande",Helvetica,Arial,Verdana,sans-serif;
		font-size: 14px;
	}

	#calendar {
		max-width: 900px;
		margin: 0 auto;
	}
	

</style>

</html>
